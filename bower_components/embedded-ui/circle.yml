machine:
  node:
    version: v0.10.26

dependencies:
  cache_directories:
    - "~/nvm/v0.10.26/lib/node_modules"
    - "~/nvm/v0.10.26/lib/bin"
    - "~/.npm"

  post:
    - npm install -g gulp@3.6.2 bower@1.3.8 protractor@0.23.1
    - bower install
    - gulp build

test:
  override:
    - echo "Tests are ran as a part of the deploy"

deployment:
  development:
    branch: dev
    commands:
      - gulp publish-dev
      - ENV=dev protractor test/protractor.conf.js

  production:
    branch: master
    commands:
      - gulp publish-staging
      - ENV=staging protractor test/protractor.conf.js
      - gulp publish-prod
